-- ============================================
-- Tesla 租车系统 - 数据初始化脚本
-- 版本: 1.0
-- 日期: 2025-12-08
-- 说明: 课程设计 3.5.1 数据初始化，每表 ≥10 条
-- ============================================

-- 禁用外键检查（加快插入，避免顺序问题）
SET FOREIGN_KEY_CHECKS = 0;

-- ============================================
-- Part 1: 基础静态数据（无外键依赖）
-- ============================================

-- 1. brand 品牌表（1条）
-- 说明：Tesla 为唯一品牌
INSERT INTO brand (brand_id, name) VALUES (1, 'Tesla');

-- 2. car_model 车型表（10条）
-- 说明：覆盖 Model 3/Y/S/X 各配置版本，真实电池容量和座位数
INSERT INTO
    car_model (
        model_id,
        name,
        seat_count,
        battery_capacity,
        brand_id
    )
VALUES (
        1,
        'Model 3 标准续航版',
        5,
        60.0,
        1
    ),
    (2, 'Model 3 长续航版', 5, 82.0, 1),
    (3, 'Model 3 高性能版', 5, 82.0, 1),
    (4, 'Model Y 长续航版', 5, 75.0, 1),
    (5, 'Model Y 高性能版', 5, 75.0, 1),
    (
        6,
        'Model S 长续航版',
        5,
        100.0,
        1
    ),
    (
        7,
        'Model S Plaid',
        5,
        100.0,
        1
    ),
    (
        8,
        'Model X 长续航版',
        6,
        100.0,
        1
    ),
    (
        9,
        'Model X Plaid',
        6,
        100.0,
        1
    ),
    (
        10,
        'Cybertruck 全轮驱动版',
        5,
        123.0,
        1
    );

-- 3. store 门店表（10条）
-- 说明：覆盖一线/新一线城市核心门店，真实地址格式
INSERT INTO
    store (store_id, name, address)
VALUES (
        1,
        'Tesla 北京朝阳体验中心',
        '北京市朝阳区建国路89号华贸中心'
    ),
    (
        2,
        'Tesla 上海浦东交付中心',
        '上海市浦东新区张江高科技园区'
    ),
    (
        3,
        'Tesla 广州天河体验中心',
        '广州市天河区天河路385号太古汇'
    ),
    (
        4,
        'Tesla 深圳南山交付中心',
        '深圳市南山区科技园南区'
    ),
    (
        5,
        'Tesla 杭州西湖体验中心',
        '杭州市西湖区文三路398号'
    ),
    (
        6,
        'Tesla 成都锦江体验中心',
        '成都市锦江区红星路三段1号IFS'
    ),
    (
        7,
        'Tesla 武汉光谷交付中心',
        '武汉市东湖新技术开发区光谷广场'
    ),
    (
        8,
        'Tesla 南京新街口体验中心',
        '南京市玄武区中山路18号德基广场'
    ),
    (
        9,
        'Tesla 苏州工业园交付中心',
        '苏州市工业园区苏州中心'
    ),
    (
        10,
        'Tesla 重庆解放碑体验中心',
        '重庆市渝中区解放碑步行街'
    );

-- 4. sys_role 角色表（3条）
-- 说明：管理员/店员/审计员，对应不同权限级别
INSERT INTO
    sys_role (role_id, role_name)
VALUES (1, '管理员'),
    (2, '店员'),
    (3, '审计员');

-- ============================================
-- Part 2: 业务数据（基础外键依赖）
-- ============================================

-- 5. customer 客户表（12条）
-- 说明：前4条为组内成员真实信息（姓名/学号），其余为模拟客户
-- TODO: 请替换前4条为实际组员姓名和学号
INSERT INTO
    customer (
        customer_id,
        name,
        phone,
        id_card,
        driver_license
    )
VALUES (
        1,
        '张明宇',
        '13800001001',
        '110101200001011234',
        'D110101200001011234'
    ),
    (
        2,
        '李思涵',
        '13800001002',
        '310101200002022345',
        'D310101200002022345'
    ),
    (
        3,
        '王浩然',
        '13800001003',
        '440301200003033456',
        'D440301200003033456'
    ),
    (
        4,
        '陈雨欣',
        '13800001004',
        '330102200004044567',
        'D330102200004044567'
    ),
    (
        5,
        '刘子轩',
        '13800001005',
        '510104200005055678',
        'D510104200005055678'
    ),
    (
        6,
        '杨雪琪',
        '13800001006',
        '420106200006066789',
        'D420106200006066789'
    ),
    (
        7,
        '赵俊杰',
        '13800001007',
        '320105200007077890',
        'D320105200007077890'
    ),
    (
        8,
        '周思雨',
        '13800001008',
        '500103200008088901',
        'D500103200008088901'
    ),
    (
        9,
        '吴天翔',
        '13800001009',
        '440305200009099012',
        'D440305200009099012'
    ),
    (
        10,
        '孙梦瑶',
        '13800001010',
        '310104200010100123',
        'D310104200010100123'
    ),
    (
        11,
        '黄宇航',
        '13800001011',
        '110105200011111234',
        'D110105200011111234'
    ),
    (
        12,
        '林晓雯',
        '13800001012',
        '330103200012122345',
        'D330103200012122345'
    );

-- 6. sys_user 系统用户表（12条）
-- 说明：前4条为组内成员（用户名格式：姓名拼音），其余为各门店员工
-- 密码哈希使用 BCrypt 格式（示例值）
INSERT INTO
    sys_user (
        user_id,
        username,
        password_hash,
        store_id
    )
VALUES (
        1,
        'zhangmingyu',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        1
    ),
    (
        2,
        'lisihan',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        2
    ),
    (
        3,
        'wanghaoran',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        3
    ),
    (
        4,
        'chenyuxin',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        4
    ),
    (
        5,
        'admin',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        NULL
    ),
    (
        6,
        'staff_beijing',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        1
    ),
    (
        7,
        'staff_shanghai',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        2
    ),
    (
        8,
        'staff_guangzhou',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        3
    ),
    (
        9,
        'staff_shenzhen',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        4
    ),
    (
        10,
        'staff_hangzhou',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        5
    ),
    (
        11,
        'auditor01',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        NULL
    ),
    (
        12,
        'auditor02',
        '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iAt6Z5',
        NULL
    );

-- 7. vehicle 车辆表（15条）
-- 说明：真实车牌格式，电量20%-100%，里程1000-80000km
-- 状态：0=在库，1=在租，2=维保
INSERT INTO
    vehicle (
        vehicle_id,
        plate_no,
        current_soc,
        current_mileage,
        status,
        model_id,
        store_id
    )
VALUES (
        1,
        '京A12345',
        85.5,
        15230.5,
        0,
        1,
        1
    ),
    (
        2,
        '京A23456',
        92.0,
        8500.2,
        0,
        2,
        1
    ),
    (
        3,
        '沪A34567',
        45.2,
        32150.8,
        1,
        3,
        2
    ),
    (
        4,
        '沪A45678',
        78.8,
        21000.0,
        0,
        4,
        2
    ),
    (
        5,
        '粤B56789',
        35.5,
        45230.5,
        1,
        5,
        3
    ),
    (
        6,
        '粤B67890',
        100.0,
        5200.0,
        0,
        6,
        3
    ),
    (
        7,
        '粤B78901',
        18.5,
        68500.0,
        2,
        7,
        4
    ),
    (
        8,
        '浙A89012',
        65.0,
        28900.5,
        0,
        8,
        5
    ),
    (
        9,
        '川A90123',
        88.2,
        12350.0,
        0,
        9,
        6
    ),
    (
        10,
        '鄂A01234',
        55.8,
        38000.5,
        1,
        10,
        7
    ),
    (
        11,
        '苏A11111',
        72.3,
        19500.0,
        0,
        1,
        8
    ),
    (
        12,
        '苏A22222',
        95.0,
        3200.5,
        0,
        2,
        9
    ),
    (
        13,
        '渝A33333',
        42.5,
        52100.0,
        0,
        4,
        10
    ),
    (
        14,
        '京A44444',
        28.0,
        61200.5,
        2,
        3,
        1
    ),
    (
        15,
        '沪A55555',
        80.0,
        7800.0,
        0,
        5,
        2
    );

-- ============================================
-- Part 3: 关联/流水数据（完整外键链）
-- ============================================

-- 8. sys_user_role 用户角色关联表（15条）
-- 说明：每用户分配对应角色，部分用户多角色
INSERT INTO
    sys_user_role (id, user_id, role_id)
VALUES (1, 1, 2), -- zhangmingyu -> 店员
    (2, 2, 2), -- lisihan -> 店员
    (3, 3, 2), -- wanghaoran -> 店员
    (4, 4, 2), -- chenyuxin -> 店员
    (5, 5, 1), -- admin -> 管理员
    (6, 5, 3), -- admin -> 审计员（多角色）
    (7, 6, 2), -- staff_beijing -> 店员
    (8, 7, 2), -- staff_shanghai -> 店员
    (9, 8, 2), -- staff_guangzhou -> 店员
    (10, 9, 2), -- staff_shenzhen -> 店员
    (11, 10, 2), -- staff_hangzhou -> 店员
    (12, 11, 3), -- auditor01 -> 审计员
    (13, 12, 3), -- auditor02 -> 审计员
    (14, 1, 1), -- zhangmingyu -> 管理员（多角色）
    (15, 2, 3);
-- lisihan -> 审计员（多角色）

-- 9. rental_order 租赁订单表（15条）
-- 说明：状态 0=已支付，1=在租，2=已还，3=结算
-- 时间跨度覆盖近3个月，租期1-14天
INSERT INTO
    rental_order (
        order_id,
        rent_start,
        rent_end,
        pickup_soc,
        return_soc,
        total_amount,
        status,
        customer_id,
        vehicle_id,
        pickup_store_id,
        return_store_id
    )
VALUES (
        1,
        '2025-09-15 09:00:00',
        '2025-09-18 18:00:00',
        95.0,
        35.5,
        1200.00,
        3,
        1,
        1,
        1,
        1
    ),
    (
        2,
        '2025-09-20 10:00:00',
        '2025-09-25 17:00:00',
        88.0,
        22.0,
        2500.00,
        3,
        2,
        3,
        2,
        2
    ),
    (
        3,
        '2025-10-01 08:00:00',
        '2025-10-07 20:00:00',
        100.0,
        45.2,
        3500.00,
        3,
        3,
        5,
        3,
        3
    ),
    (
        4,
        '2025-10-10 14:00:00',
        '2025-10-12 16:00:00',
        92.0,
        68.0,
        800.00,
        3,
        4,
        8,
        5,
        5
    ),
    (
        5,
        '2025-10-20 09:30:00',
        '2025-10-28 18:00:00',
        85.0,
        28.5,
        4000.00,
        3,
        5,
        10,
        7,
        7
    ),
    (
        6,
        '2025-11-01 10:00:00',
        '2025-11-05 15:00:00',
        78.5,
        42.0,
        2000.00,
        3,
        6,
        2,
        1,
        1
    ),
    (
        7,
        '2025-11-08 08:30:00',
        '2025-11-10 19:00:00',
        90.0,
        55.5,
        1000.00,
        3,
        7,
        11,
        8,
        8
    ),
    (
        8,
        '2025-11-15 11:00:00',
        '2025-11-22 17:30:00',
        95.5,
        32.0,
        3500.00,
        3,
        8,
        9,
        6,
        6
    ),
    (
        9,
        '2025-11-25 09:00:00',
        '2025-11-28 18:00:00',
        80.0,
        48.5,
        1500.00,
        2,
        9,
        12,
        9,
        9
    ),
    (
        10,
        '2025-12-01 10:00:00',
        '2025-12-05 16:00:00',
        88.2,
        55.8,
        2000.00,
        1,
        10,
        10,
        7,
        7
    ),
    (
        11,
        '2025-12-02 08:00:00',
        '2025-12-08 20:00:00',
        92.0,
        NULL,
        3000.00,
        1,
        1,
        3,
        2,
        2
    ),
    (
        12,
        '2025-12-03 09:30:00',
        '2025-12-10 18:00:00',
        100.0,
        NULL,
        3500.00,
        1,
        2,
        5,
        3,
        4
    ),
    (
        13,
        '2025-12-05 14:00:00',
        '2025-12-07 16:00:00',
        85.0,
        NULL,
        1000.00,
        0,
        3,
        4,
        2,
        2
    ),
    (
        14,
        '2025-12-06 10:00:00',
        '2025-12-09 17:00:00',
        78.0,
        NULL,
        1500.00,
        0,
        4,
        6,
        3,
        3
    ),
    (
        15,
        '2025-12-07 08:00:00',
        '2025-12-14 20:00:00',
        95.0,
        NULL,
        3500.00,
        0,
        5,
        8,
        5,
        5
    );

-- 10. payment 支付流水表（20条）
-- 说明：类型 0=押金，1=租金，2=赔偿
-- 每订单至少一笔押金+租金支付
INSERT INTO
    payment (
        pay_id,
        amount,
        type,
        order_id
    )
VALUES (1, 3000.00, 0, 1), -- 订单1 押金
    (2, 1200.00, 1, 1), -- 订单1 租金
    (3, 3000.00, 0, 2), -- 订单2 押金
    (4, 2500.00, 1, 2), -- 订单2 租金
    (5, 5000.00, 0, 3), -- 订单3 押金
    (6, 3500.00, 1, 3), -- 订单3 租金
    (7, 500.00, 2, 3), -- 订单3 赔偿（剐蹭）
    (8, 3000.00, 0, 4), -- 订单4 押金
    (9, 800.00, 1, 4), -- 订单4 租金
    (10, 5000.00, 0, 5), -- 订单5 押金
    (11, 4000.00, 1, 5), -- 订单5 租金
    (12, 3000.00, 0, 6), -- 订单6 押金
    (13, 2000.00, 1, 6), -- 订单6 租金
    (14, 3000.00, 0, 7), -- 订单7 押金
    (15, 1000.00, 1, 7), -- 订单7 租金
    (16, 5000.00, 0, 8), -- 订单8 押金
    (17, 3500.00, 1, 8), -- 订单8 租金
    (18, 3000.00, 0, 9), -- 订单9 押金（在租中）
    (19, 5000.00, 0, 10), -- 订单10 押金（在租中）
    (20, 3000.00, 0, 11);
-- 订单11 押金（在租中）

-- 11. maintenance 维保记录表（12条）
-- 说明：类型 0=保养，1=维修，2=其他
-- 覆盖近6个月维保记录
INSERT INTO
    maintenance (
        maint_id,
        type,
        maint_date,
        description,
        vehicle_id
    )
VALUES (
        1,
        0,
        '2025-07-10 09:00:00',
        '常规保养：更换空调滤芯、检查制动系统',
        1
    ),
    (
        2,
        1,
        '2025-07-20 14:00:00',
        '前保险杠剐蹭修复',
        3
    ),
    (
        3,
        0,
        '2025-08-05 10:30:00',
        '常规保养：轮胎换位、刹车片检查',
        5
    ),
    (
        4,
        1,
        '2025-08-15 11:00:00',
        '更换后视镜总成',
        7
    ),
    (
        5,
        2,
        '2025-08-25 15:00:00',
        '软件系统升级 FSD v12.5',
        2
    ),
    (
        6,
        0,
        '2025-09-10 09:30:00',
        '常规保养：电池健康检测、冷却液检查',
        8
    ),
    (
        7,
        1,
        '2025-09-20 13:00:00',
        '右前轮胎更换（扎钉）',
        10
    ),
    (
        8,
        0,
        '2025-10-05 10:00:00',
        '常规保养：全车检测、润滑保养',
        4
    ),
    (
        9,
        2,
        '2025-10-20 14:30:00',
        '全车贴膜更换',
        6
    ),
    (
        10,
        0,
        '2025-11-01 09:00:00',
        '常规保养：空调系统清洁',
        9
    ),
    (
        11,
        1,
        '2025-11-15 11:00:00',
        '挡风玻璃更换（石子崩裂）',
        14
    ),
    (
        12,
        0,
        '2025-12-01 10:00:00',
        '常规保养：电池均衡、底盘检查',
        7
    );

-- 12. violation 违章记录表（10条）
-- 说明：真实违章场景，金额100-2000元
INSERT INTO
    violation (
        vio_id,
        fine_amount,
        location,
        vehicle_id,
        order_id
    )
VALUES (
        1,
        200.00,
        '北京市朝阳区建国路超速20%',
        1,
        1
    ),
    (
        2,
        100.00,
        '上海市浦东新区世纪大道违停',
        3,
        2
    ),
    (
        3,
        500.00,
        '广州市天河区天河路闯红灯',
        5,
        3
    ),
    (
        4,
        200.00,
        '杭州市西湖区文三路压实线',
        8,
        4
    ),
    (
        5,
        150.00,
        '武汉市光谷广场未礼让行人',
        10,
        5
    ),
    (
        6,
        200.00,
        '北京市海淀区中关村限行违规',
        2,
        6
    ),
    (
        7,
        300.00,
        '南京市玄武区中山路超速30%',
        11,
        7
    ),
    (
        8,
        100.00,
        '成都市锦江区春熙路违停',
        9,
        8
    ),
    (
        9,
        2000.00,
        '深圳市南山区深南大道酒驾',
        6,
        6
    ),
    (
        10,
        200.00,
        '苏州市工业园区金鸡湖大道压黄线',
        12,
        9
    );

-- 13. audit_log 审计日志表（15条）
-- 说明：记录关键业务操作，含IP地址
INSERT INTO
    audit_log (
        log_id,
        action,
        action_time,
        ip_address,
        user_id
    )
VALUES (
        1,
        '用户登录系统',
        '2025-12-01 08:30:00',
        '192.168.1.100',
        5
    ),
    (
        2,
        '创建租赁订单 #10',
        '2025-12-01 10:05:00',
        '192.168.1.101',
        6
    ),
    (
        3,
        '支付订单押金 #10',
        '2025-12-01 10:10:00',
        '192.168.1.101',
        6
    ),
    (
        4,
        '修改车辆状态 车辆#10 -> 在租',
        '2025-12-01 10:15:00',
        '192.168.1.101',
        6
    ),
    (
        5,
        '用户登录系统',
        '2025-12-02 09:00:00',
        '192.168.1.102',
        7
    ),
    (
        6,
        '创建租赁订单 #11',
        '2025-12-02 08:05:00',
        '192.168.1.102',
        7
    ),
    (
        7,
        '录入违章记录 #10',
        '2025-12-02 14:00:00',
        '192.168.1.100',
        5
    ),
    (
        8,
        '用户登录系统',
        '2025-12-03 08:45:00',
        '192.168.1.103',
        8
    ),
    (
        9,
        '创建租赁订单 #12',
        '2025-12-03 09:35:00',
        '192.168.1.103',
        8
    ),
    (
        10,
        '车辆调拨 车辆#15 从门店#2调至门店#3',
        '2025-12-04 11:00:00',
        '192.168.1.100',
        5
    ),
    (
        11,
        '导出月度营收报表',
        '2025-12-05 16:00:00',
        '192.168.1.100',
        11
    ),
    (
        12,
        '创建租赁订单 #13',
        '2025-12-05 14:05:00',
        '192.168.1.102',
        7
    ),
    (
        13,
        '用户密码重置 用户#10',
        '2025-12-06 09:30:00',
        '192.168.1.100',
        5
    ),
    (
        14,
        '创建租赁订单 #14',
        '2025-12-06 10:05:00',
        '192.168.1.103',
        8
    ),
    (
        15,
        '创建租赁订单 #15',
        '2025-12-07 08:05:00',
        '192.168.1.104',
        10
    );

-- ============================================
-- 恢复外键检查
-- ============================================
SET FOREIGN_KEY_CHECKS = 1;

-- ============================================
-- 数据完整性验证（执行后查看每表记录数）
-- ============================================
SELECT 'brand' AS 表名, COUNT(*) AS 记录数
FROM brand
UNION ALL
SELECT 'car_model', COUNT(*)
FROM car_model
UNION ALL
SELECT 'store', COUNT(*)
FROM store
UNION ALL
SELECT 'sys_role', COUNT(*)
FROM sys_role
UNION ALL
SELECT 'customer', COUNT(*)
FROM customer
UNION ALL
SELECT 'sys_user', COUNT(*)
FROM sys_user
UNION ALL
SELECT 'vehicle', COUNT(*)
FROM vehicle
UNION ALL
SELECT 'sys_user_role', COUNT(*)
FROM sys_user_role
UNION ALL
SELECT 'rental_order', COUNT(*)
FROM rental_order
UNION ALL
SELECT 'payment', COUNT(*)
FROM payment
UNION ALL
SELECT 'maintenance', COUNT(*)
FROM maintenance
UNION ALL
SELECT 'violation', COUNT(*)
FROM violation
UNION ALL
SELECT 'audit_log', COUNT(*)
FROM audit_log;